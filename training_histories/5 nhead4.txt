(pytorch) C:\Users\Yutian\Documents\Further Studies\2020 Sem 1 EB5002 Text Processing\CA\Singlish-Pytorch-Word-Language-Model>python main.py --cuda --model Transformer --nhead 4 --save models/transformer-nhead4.pt
| epoch   1 |   200/  548 batches | lr 20.00 | ms/batch 71.61 | loss 11.23 | ppl 75692.79
| epoch   1 |   400/  548 batches | lr 20.00 | ms/batch 70.87 | loss  9.86 | ppl 19198.31
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 43.73s | valid loss 10.15 | valid ppl 25533.87
-----------------------------------------------------------------------------------------
| epoch   2 |   200/  548 batches | lr 20.00 | ms/batch 70.41 | loss  9.60 | ppl 14740.32
| epoch   2 |   400/  548 batches | lr 20.00 | ms/batch 71.26 | loss  9.55 | ppl 14037.14
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 44.23s | valid loss  8.07 | valid ppl  3194.62
-----------------------------------------------------------------------------------------
| epoch   3 |   200/  548 batches | lr 20.00 | ms/batch 67.32 | loss  9.49 | ppl 13165.64
| epoch   3 |   400/  548 batches | lr 20.00 | ms/batch 69.04 | loss  9.46 | ppl 12859.03
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 43.15s | valid loss  9.29 | valid ppl 10825.20
-----------------------------------------------------------------------------------------
| epoch   4 |   200/  548 batches | lr 5.00 | ms/batch 66.65 | loss  7.60 | ppl  1990.53
| epoch   4 |   400/  548 batches | lr 5.00 | ms/batch 65.92 | loss  7.53 | ppl  1866.43
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 41.15s | valid loss  7.62 | valid ppl  2033.99
-----------------------------------------------------------------------------------------
| epoch   5 |   200/  548 batches | lr 5.00 | ms/batch 66.18 | loss  7.55 | ppl  1908.01
| epoch   5 |   400/  548 batches | lr 5.00 | ms/batch 65.76 | loss  7.51 | ppl  1831.64
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 41.02s | valid loss  7.61 | valid ppl  2012.63
-----------------------------------------------------------------------------------------
| epoch   6 |   200/  548 batches | lr 5.00 | ms/batch 66.02 | loss  7.54 | ppl  1883.29
| epoch   6 |   400/  548 batches | lr 5.00 | ms/batch 65.82 | loss  7.50 | ppl  1801.48
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 40.94s | valid loss  7.60 | valid ppl  1994.67
-----------------------------------------------------------------------------------------
| epoch   7 |   200/  548 batches | lr 5.00 | ms/batch 66.04 | loss  7.53 | ppl  1859.26
| epoch   7 |   400/  548 batches | lr 5.00 | ms/batch 65.56 | loss  7.48 | ppl  1780.56
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 40.90s | valid loss  7.60 | valid ppl  1990.65
-----------------------------------------------------------------------------------------
| epoch   8 |   200/  548 batches | lr 5.00 | ms/batch 65.95 | loss  7.52 | ppl  1838.43
| epoch   8 |   400/  548 batches | lr 5.00 | ms/batch 65.53 | loss  7.47 | ppl  1760.04
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 41.58s | valid loss  7.59 | valid ppl  1984.21
-----------------------------------------------------------------------------------------
| epoch   9 |   200/  548 batches | lr 5.00 | ms/batch 66.97 | loss  7.51 | ppl  1824.57
| epoch   9 |   400/  548 batches | lr 5.00 | ms/batch 69.01 | loss  7.47 | ppl  1751.80
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 42.45s | valid loss  7.59 | valid ppl  1985.92
-----------------------------------------------------------------------------------------
| epoch  10 |   200/  548 batches | lr 1.25 | ms/batch 68.56 | loss  7.45 | ppl  1721.32
| epoch  10 |   400/  548 batches | lr 1.25 | ms/batch 69.60 | loss  7.41 | ppl  1652.24
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 42.64s | valid loss  7.52 | valid ppl  1836.86
-----------------------------------------------------------------------------------------
| epoch  11 |   200/  548 batches | lr 1.25 | ms/batch 68.25 | loss  7.45 | ppl  1714.81
| epoch  11 |   400/  548 batches | lr 1.25 | ms/batch 67.98 | loss  7.41 | ppl  1648.78
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 42.33s | valid loss  7.52 | valid ppl  1837.52
-----------------------------------------------------------------------------------------
| epoch  12 |   200/  548 batches | lr 0.31 | ms/batch 68.73 | loss  7.45 | ppl  1717.48
| epoch  12 |   400/  548 batches | lr 0.31 | ms/batch 69.08 | loss  7.41 | ppl  1646.36
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 42.69s | valid loss  7.51 | valid ppl  1827.41
-----------------------------------------------------------------------------------------
| epoch  13 |   200/  548 batches | lr 0.31 | ms/batch 68.28 | loss  7.45 | ppl  1711.77
| epoch  13 |   400/  548 batches | lr 0.31 | ms/batch 67.88 | loss  7.41 | ppl  1644.76
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 42.23s | valid loss  7.51 | valid ppl  1827.11
-----------------------------------------------------------------------------------------
| epoch  14 |   200/  548 batches | lr 0.31 | ms/batch 68.25 | loss  7.44 | ppl  1710.26
| epoch  14 |   400/  548 batches | lr 0.31 | ms/batch 67.97 | loss  7.40 | ppl  1643.92
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 42.48s | valid loss  7.51 | valid ppl  1827.18
-----------------------------------------------------------------------------------------
| epoch  15 |   200/  548 batches | lr 0.08 | ms/batch 68.36 | loss  7.45 | ppl  1712.09
| epoch  15 |   400/  548 batches | lr 0.08 | ms/batch 67.89 | loss  7.40 | ppl  1642.98
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 42.27s | valid loss  7.51 | valid ppl  1826.00
-----------------------------------------------------------------------------------------
| epoch  16 |   200/  548 batches | lr 0.08 | ms/batch 68.37 | loss  7.44 | ppl  1709.45
| epoch  16 |   400/  548 batches | lr 0.08 | ms/batch 67.87 | loss  7.40 | ppl  1642.24
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 42.30s | valid loss  7.51 | valid ppl  1825.81
-----------------------------------------------------------------------------------------
| epoch  17 |   200/  548 batches | lr 0.08 | ms/batch 68.36 | loss  7.44 | ppl  1708.59
| epoch  17 |   400/  548 batches | lr 0.08 | ms/batch 67.94 | loss  7.40 | ppl  1641.97
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 42.53s | valid loss  7.51 | valid ppl  1825.80
-----------------------------------------------------------------------------------------
| epoch  18 |   200/  548 batches | lr 0.08 | ms/batch 68.44 | loss  7.44 | ppl  1707.87
| epoch  18 |   400/  548 batches | lr 0.08 | ms/batch 67.90 | loss  7.40 | ppl  1641.79
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 42.66s | valid loss  7.51 | valid ppl  1825.80
-----------------------------------------------------------------------------------------
| epoch  19 |   200/  548 batches | lr 0.08 | ms/batch 68.36 | loss  7.44 | ppl  1707.50
| epoch  19 |   400/  548 batches | lr 0.08 | ms/batch 67.79 | loss  7.40 | ppl  1641.57
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 42.28s | valid loss  7.51 | valid ppl  1825.83
-----------------------------------------------------------------------------------------
| epoch  20 |   200/  548 batches | lr 0.02 | ms/batch 68.16 | loss  7.44 | ppl  1707.77
| epoch  20 |   400/  548 batches | lr 0.02 | ms/batch 67.83 | loss  7.40 | ppl  1641.24
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 42.19s | valid loss  7.51 | valid ppl  1825.91
-----------------------------------------------------------------------------------------
=========================================================================================
| End of training | test loss  7.48 | test ppl  1769.68
=========================================================================================